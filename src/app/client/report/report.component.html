<div class="container mt-5 mb-5">
  <h3>Reports</h3>

  <app-date-picker [mode]="'date'"
                   (dateRangeChange)="onDateRangeSelected($event)"
                   [initialFromDate]="{year: 2024, month: 1, day: 1}"
                   [initialToDate]="{year: 2024, month: 12, day: 31}">
  </app-date-picker>

  <button class="btn btn-primary"
          (click)="fetchGenericCount()"
          [disabled]="!datesValid() || !anyReportEnabled() || loading()">
    @if (loading()) {
      <span>Loading...</span>
    } @else {
      <span>Fetch Reports</span>
    }
  </button>

  @if (generalError()) {
    <div class="mt-3 alert alert-danger">{{ generalError() }}</div>
  }

  <div class="form-check mt-4">
    <input class="form-check-input"
           type="checkbox"
           [(ngModel)]="totalNumberOfClientsEnabled"
           id="totalNumber">
    <label class="form-check-label" for="totalNumber">
      Get the total number of people who received advice within a specific time period.
    </label>
  </div>

  @if (totalNumberOfClientsError()) {
    <div class="mt-3 alert alert-danger">{{ totalNumberOfClientsError() }}</div>
  }
  @if (!totalNumberOfClientsError() && totalNumberOfClientsResult() !== null) {
    <div class="mt-3 alert alert-info">
      Total number of clients in Range: <strong>{{ totalNumberOfClientsResult() }}</strong>
    </div>
  }

  <div class="form-check mt-3">
    <input class="form-check-input"
           type="checkbox"
           [(ngModel)]="nationalityCountEnabled"
           id="nationalityCount">
    <label class="form-check-label" for="nationalityCount">
      Receive the specified nationalities
    </label>
  </div>

  @if (nationalityError()) {
    <div class="mt-3 alert alert-danger">{{ nationalityError() }}</div>
  }
  @if (!nationalityError() && nationalitiesResult() !== null) {
    <div class="mt-3 alert alert-info">
      Nationalities in range:<br>
      <strong>
        @for (nationality of nationalitiesResult(); track nationality.nationality) {
          <hr>
          <span [innerHTML]="nationality.nationality"></span>:
          <span [innerHTML]="nationality.count"></span>
        }
      </strong>
    </div>
  }

  <div class="form-check mt-3">
    <input class="form-check-input"
           type="checkbox"
           [(ngModel)]="firstCounselingOnlyEnabled"
           id="firstCounselingOnly">
    <label class="form-check-label" for="firstCounselingOnly">
      Get the number of clients who received a consultation for the first time within the specified time period.
    </label>
  </div>

  @if (firstCounselingOnlyError()) {
    <div class="mt-3 alert alert-danger">{{ firstCounselingOnlyError() }}</div>
  }
  @if (!firstCounselingOnlyError() && firstCounselingOnlyResult() !== null) {
    <div class="mt-3 alert alert-info">
      Number of clients with first counseling in range: <strong>{{ firstCounselingOnlyResult() }}</strong>
    </div>
  }

  <div class="form-check mt-3">
    <input
      class="form-check-input"
      type="checkbox"
      [(ngModel)]="languagesUsedEnabled"
      id="languagesUsed">
    <label class="form-check-label" for="languagesUsed">
      Get the number of languages used in the consultation for which an interpreter was required
    </label>
  </div>

  @if (languageError()) {
    <div class="mt-3 alert alert-danger">{{ languageError() }}</div>
  }
  @if (!languageError() && languagesUsedResult() !== null) {
    <div class="mt-3 alert alert-info">
      languages in range:<br>
      <strong>
        @for (language of languagesUsedResult(); track language.language) {
          <hr>
          <span [innerHTML]="language.language"></span>:
          <span [innerHTML]="language.count"></span>
        }
      </strong>
    </div>
  }

  <div class="form-check mt-3">
    <input
      class="form-check-input"
      type="checkbox"
      [(ngModel)]="genderEnabled"
      id="genderCount">
    <label class="form-check-label" for="genderCount">
      Get the genders and how many clients are assigned to each
    </label>
  </div>

  @if (genderError()) {
    <div class="mt-3 alert alert-danger">{{ genderError() }}</div>
  }
  @if (!genderError() && gendersResult() !== null) {
    <div class="mt-3 alert alert-info">
      genders and assignees: <br>
      <strong>
        @for (gender of gendersResult(); track gender.gender) {
          <hr>
          <span [innerHTML]="gender.gender"></span>:
          <span [innerHTML]="gender.count"></span>
        }
      </strong>
    </div>
  }

  <div class="form-check mt-3">
    <input
      class="form-check-input"
      type="checkbox"
      [(ngModel)]="sectorEnabled"
      id="sectorCount">
    <label class="form-check-label" for="sectorCount">
      Get the sectors and how many clients are assigned to each
    </label>
  </div>

  @if (sectorError()) {
    <div class="mt-3 alert alert-danger">{{ sectorError() }}</div>
  }
  @if (!sectorError() && sectorResult() !== null) {
    <div class="mt-3 alert alert-info">
      sectors and assignees: <br>
      <strong>
        @for (sector of sectorResult(); track sector.sector) {
          <hr>
          <span [innerHTML]="sector.sector"></span>:
          <span [innerHTML]="sector.count"></span>
        }
      </strong>
    </div>
  }

  <div class="form-check mt-3">
    <input
      class="form-check-input"
      type="checkbox"
      [(ngModel)]="activityEnabled"
      id="activityCount">
    <label class="form-check-label" for="activityCount">
      Get the counselingActivities and how many clients are assigned to each
    </label>
  </div>

  @if (activityError()) {
    <div class="mt-3 alert alert-danger">{{ activityError() }}</div>
  }
  @if (!activityError() && activityResult() !== null) {
    <div class="mt-3 alert alert-info">
      activities and assignees: <br>
      <strong>
        @for (activity of activityResult(); track activity.activity) {
          <hr>
          <span [innerHTML]="activity.activity"></span>:
          <span [innerHTML]="activity.count"></span>
        }
      </strong>
    </div>
  }
</div>
